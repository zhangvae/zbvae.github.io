<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>数据结构-串 | zbvae&#39;s blog</title>
  <meta name="description" content="这个世界怎么了，明明可以靠才华吃饭，偏要靠脸!" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/component.css" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <meta name="generator" content="zbvae's blog">
  <script src="http://static.duoshuo.com/embed.js"></script>
  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  

</head>
<body>
<div class="container">
    <div class="mp-pusher" id="mp-pusher">
        <i id="scroll-up" class="fa fa-angle-up"></i>
        <nav id="mp-menu" class="mp-menu">
            <div class="mp-level">
                <a data-pjax class="back-home" style="font-size: 20px" href="/"><h2 ><i class="fa fa-home"></i>
                        Home</h2></a>
                <ul class="first-level">
                    <li>
                        <a class="fa fa-archive" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;Archive</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-archive"></i>
                                Archive</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-archive" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2016/03/17/Java微信公众号应用部署在阿里云ECS/">Java微信公众号应用部署在阿里云ECS</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2016/03/08/CENTOS-6-5安装vncserver/">CENTOS 6.5安装vncserver</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2016/02/24/新新新年/">新新新年</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/31/Java-Web中文乱码问题解决方法/">Java Web中文乱码问题解决方法</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/28/数据结构-内排序算法/">数据结构-内排序算法</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/26/数据结构-图/">数据结构-图</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/23/数据结构-二叉树/">数据结构-二叉树</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/21/数据结构-多维数组和广义表/">数据结构-多维数组和广义表</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/20/数据结构-串/">数据结构-串</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/20/数据结构-栈与队列/">数据结构-栈与队列</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/19/数据结构-线性表/">数据结构-线性表</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/18/八皇后问题/">八皇后问题</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/12/Java-NIO-学习/">Java NIO 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-类集/">Java 类集</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-比较器/">Java 比较器</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/正则表达式/">正则表达式</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/XML-学习/">XML 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-JDBC-学习/">Java JDBC 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-多线程/">Java 多线程</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-反射/">Java 反射</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/使用Echarts制作散点图-Excel-导入数据方式/">使用Echarts制作散点图(Excel 导入数据方式)</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-对象克隆/">Java 对象克隆</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-对象序列化与反序列化/">Java 对象序列化与反序列化</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-IO-学习/">Java IO 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/09/使用Hexo和Github搭建自己的个人博客网站/">使用Hexo和Github搭建自己的个人博客网站</a>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-copy" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;Categories</a>

                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-copy"></i>
                                Categories</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-category" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-tags" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;Tags</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-tags"></i>
                                Tags</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-tag" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/Java学习/">&nbsp;&nbsp;&nbsp;Java学习</a>
                                    <small>9</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/云服务器/">&nbsp;&nbsp;&nbsp;云服务器</a>
                                    <small>2</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/微信公众号/">&nbsp;&nbsp;&nbsp;微信公众号</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/心情/">&nbsp;&nbsp;&nbsp;心情</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/技术/">&nbsp;&nbsp;&nbsp;技术</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/技术交流/">&nbsp;&nbsp;&nbsp;技术交流</a>
                                    <small>6</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/数据结构/">&nbsp;&nbsp;&nbsp;数据结构</a>
                                    <small>7</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/随笔/">&nbsp;&nbsp;&nbsp;随笔</a>
                                    <small>1</small>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    
                    <li class="mp-pjax"><a class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;About me</a></li>
                    <li><a class="fa fa-github" href="#">&nbsp;&nbsp;&nbsp;Github</a></li>

                </ul>

            </div>
        </nav>
        <div id="pjax">
            <div class="pjax-hidden" style="display: none">
                
                    <a  data-pjax href="/2016/03/17/Java微信公众号应用部署在阿里云ECS/">Java微信公众号应用部署在阿里云ECS</a>
                
                    <a  data-pjax href="/2016/03/08/CENTOS-6-5安装vncserver/">CENTOS 6.5安装vncserver</a>
                
                    <a  data-pjax href="/2016/02/24/新新新年/">新新新年</a>
                
                    <a  data-pjax href="/2015/07/31/Java-Web中文乱码问题解决方法/">Java Web中文乱码问题解决方法</a>
                
                    <a  data-pjax href="/2015/07/28/数据结构-内排序算法/">数据结构-内排序算法</a>
                
                    <a  data-pjax href="/2015/07/26/数据结构-图/">数据结构-图</a>
                
                    <a  data-pjax href="/2015/07/23/数据结构-二叉树/">数据结构-二叉树</a>
                
                    <a  data-pjax href="/2015/07/21/数据结构-多维数组和广义表/">数据结构-多维数组和广义表</a>
                
                    <a  data-pjax href="/2015/07/20/数据结构-串/">数据结构-串</a>
                
                    <a  data-pjax href="/2015/07/20/数据结构-栈与队列/">数据结构-栈与队列</a>
                
                    <a  data-pjax href="/2015/07/19/数据结构-线性表/">数据结构-线性表</a>
                
                    <a  data-pjax href="/2015/07/18/八皇后问题/">八皇后问题</a>
                
                    <a  data-pjax href="/2015/07/12/Java-NIO-学习/">Java NIO 学习</a>
                
                    <a  data-pjax href="/2015/07/11/Java-类集/">Java 类集</a>
                
                    <a  data-pjax href="/2015/07/11/Java-比较器/">Java 比较器</a>
                
                    <a  data-pjax href="/2015/07/11/正则表达式/">正则表达式</a>
                
                    <a  data-pjax href="/2015/07/11/XML-学习/">XML 学习</a>
                
                    <a  data-pjax href="/2015/07/11/Java-JDBC-学习/">Java JDBC 学习</a>
                
                    <a  data-pjax href="/2015/07/11/Java-多线程/">Java 多线程</a>
                
                    <a  data-pjax href="/2015/07/11/Java-反射/">Java 反射</a>
                
                    <a  data-pjax href="/2015/07/11/使用Echarts制作散点图-Excel-导入数据方式/">使用Echarts制作散点图(Excel 导入数据方式)</a>
                
                    <a  data-pjax href="/2015/07/11/Java-对象克隆/">Java 对象克隆</a>
                
                    <a  data-pjax href="/2015/07/11/Java-对象序列化与反序列化/">Java 对象序列化与反序列化</a>
                
                    <a  data-pjax href="/2015/07/11/Java-IO-学习/">Java IO 学习</a>
                
                    <a  data-pjax href="/2015/07/09/使用Hexo和Github搭建自己的个人博客网站/">使用Hexo和Github搭建自己的个人博客网站</a>
                
                
                
                    <a data-pjax href="/tags/Java学习/">&nbsp;&nbsp;Java学习</a>
                
                    <a data-pjax href="/tags/云服务器/">&nbsp;&nbsp;云服务器</a>
                
                    <a data-pjax href="/tags/微信公众号/">&nbsp;&nbsp;微信公众号</a>
                
                    <a data-pjax href="/tags/心情/">&nbsp;&nbsp;心情</a>
                
                    <a data-pjax href="/tags/技术/">&nbsp;&nbsp;技术</a>
                
                    <a data-pjax href="/tags/技术交流/">&nbsp;&nbsp;技术交流</a>
                
                    <a data-pjax href="/tags/数据结构/">&nbsp;&nbsp;数据结构</a>
                
                    <a data-pjax href="/tags/随笔/">&nbsp;&nbsp;随笔</a>
                
                <a data-pjax class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;About me</a>
            </div>
            <nav class="nexus">
                <li  style="border-left: 1px solid #c6d0da;">
                    <a id="trigger" href="#"><i class="fa fa-bars"></i></a>
                </li>
                <li ><a id="nexus-back" data-pjax href="/">zbvae&#39;s blog</a></li>
                
                <div id="nav-container">
                    <div class="post-navbar" style="line-height: 63px;display:none">
                        <li id="navbar-title"><a href="#">数据结构-串</a></li>
                        <li id="navbar-toc" style="border-left: none">
                            <a style="padding-right: 15px">
                                <span id="toc-content" >Introduction</span><i class="fa fa-chevron-down" ></i>
                            </a>
                            <div class="hidden-box">
                                <ul id="toc"></ul>
                            </div>
                        </li>
                    </div>
                </div>
                
            </nav>

            <div class="scroller">
            <div class="scroller-inner">


<!-- -->
<!--<body class="post-template">-->
<!---->
  

<main class="content" role="main">
    <article class="post" >
    <span class="post-meta">
                  <div class="tag-tile">
                      
                      
                      <a data-pjax href='/tags/数据结构/' style='color:#D5D5D5'>数据结构</a>
                      
                      
                  </div>
                <h1 class="post-title" style="margin: 14px 0;color:#50585D">数据结构-串</h1>

                    <div class="post-meta">
                        Post on<span class="fa fa-clock-o"></span>
                        <time datetime="2015-07-20T07:00:00.000Z"
                              itemprop="datePublished">2015-07-20</time>
                    </div>
    </span>

        <section class="post-content">
            <p><strong>摘要</strong> 串是一种数据元素类型只能为字符的线性数据结构，可以理解为字符序列。按存储结构也可以分为顺序串和链式串，一般以顺序串为代表，定义在串上的操作，如求串长，判断空串，判断串是否为满，指定位置插入字符，指定位置删除字符，这些操作与线性表中一模一样，所以，有兴趣的读者可以参照本系列博客数据结构-线性表进行阅读。对于串，主要算法有模式匹配，而本文所讲的重点也是串的KMP模式匹配算法。<a id="more"></a></p>
<h2 id="1-串的定义">1.串的定义</h2><p>串是一种类似线性表的线性数据结构，其数据类型只能为字符，下面是顺序串的定义，可以发现与顺序表的定义一模一样。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SeqString</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STRING_SIZE = <span class="number">100</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">char</span> data[] = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SeqString</span><span class="params">()</span></span>&#123;</span><br><span class="line">		data = <span class="keyword">new</span> <span class="keyword">char</span>[STRING_SIZE];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SeqString</span><span class="params">(<span class="keyword">char</span>[] data)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.data = <span class="keyword">new</span> <span class="keyword">char</span>[STRING_SIZE];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;data.length;i++)&#123;</span><br><span class="line">			<span class="keyword">this</span>.insert(i+<span class="number">1</span>, data[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">length</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.length;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.length == <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFull</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.length == STRING_SIZE;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">char</span> val)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(pos &lt; <span class="number">1</span> || pos &gt; length+<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.isFull())</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=length-<span class="number">1</span>;i&gt;=pos-<span class="number">1</span>;i--)</span><br><span class="line">			data[i+<span class="number">1</span>] = data[i];</span><br><span class="line">		data[pos-<span class="number">1</span>] = val;</span><br><span class="line">		<span class="keyword">this</span>.length++;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">char</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(pos &lt; <span class="number">1</span> || pos &gt; length)</span><br><span class="line">			<span class="keyword">return</span> <span class="string">'#'</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.isEmpty())</span><br><span class="line">			<span class="keyword">return</span> <span class="string">'#'</span>;</span><br><span class="line">		<span class="keyword">char</span> c = data[pos-<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=pos;i&lt;length;i++)</span><br><span class="line">			data[i-<span class="number">1</span>] = data[i];</span><br><span class="line">		<span class="keyword">this</span>.length--;</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> String(<span class="keyword">this</span>.data,<span class="number">0</span>,<span class="keyword">this</span>.length);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于串的结构类型定义，这里就不再赘述。下面介绍串的模式匹配算法。先以朴素匹配算法作为引例，然后在此基础之上，介绍KMP算法。</p>
<h2 id="2-朴素匹配算法">2.朴素匹配算法</h2><p>串的朴素匹配算法，实现简单，容易理解，也可以认为是一种暴力匹配算法，将主串与模式串中的字符进行一个一个的比对，如果匹配成功，主串与模式串各自递进向前滑动一位，如果匹配失败，那么一切从头来过，模式串重新从0位置开始，主串从下一个位置开始，这里的下一个位置的计算(i-j+1，因为j走了多少，i也走了多少，然后下一个也就是加1)，循环结束条件为模式串匹配完毕，即在主串中找到了所有模式串的字符，或者主串都走完了，还没有找到与模式串匹配的子串，结束匹配，返回-1.</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * [indexOf description]</span><br><span class="line"> * @param  t [mask <span class="type">string</span>]</span><br><span class="line"> * @<span class="constant">return</span>   [<span class="keyword">first</span> pos <span class="keyword">of</span> mask <span class="keyword">in</span> main <span class="type">string</span>]</span><br><span class="line"> */</span><br><span class="line">public int indexOf(SeqString t)&#123;</span><br><span class="line">	SeqString s = this;</span><br><span class="line">	int i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(i &lt; s.<span class="property">length</span> &amp;&amp; j &lt; t.<span class="property">length</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s.data[i] == t.data[j])&#123;</span><br><span class="line">			i++;</span><br><span class="line">			j++;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			j=<span class="number">0</span>;</span><br><span class="line">			i = i-j+<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(j == t.<span class="property">length</span>)</span><br><span class="line"><span class="command">		return</span> i-j;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line"><span class="command">		return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-KMP模式匹配算法">3.KMP模式匹配算法</h2><p>上述朴素匹配算法，实现简单，易于理解，但是其时间复杂度时O(m*n)，其中m是主串长度，n是模式串长度。算法的关键在于，当主串中i位置字符与模式串中j位置字符失配时，模式串从0开始，主串也回溯到i-j+1的位置，其实如果充分利用模式串失配位置字符之前的字符序列信息，就可以发现，主串不需要回溯，只需要回溯模式串即可，而且模式串每次回溯的步长可以根据失配位置之前的字符隐含关系来确定，失配位置之前的所有字符如果拥有相同前缀和后缀字符，那么模式串就可以不用回溯到开始位置，而只需要回溯到最长公共前缀的下一个位置即可。这样主串不用回溯，模式串减少回溯的位置，该算法的时间复杂度变为O(m+n)。</p>
<p>Knuth-Morris-Pratt 字符串查找算法，简称为 “KMP算法”，常用于在一个文本串S内查找一个模式串P 的出现位置，这个算法由Donald Knuth、Vaughan Pratt、James H. Morris三人于1977年联合发表，故取这3人的姓氏命名此算法。</p>
<h3 id="3-1next_数组的计算">3.1next 数组的计算</h3><p>定义next数组为模式串中每一个字符之前的最长公共前缀后缀的长度。同时定义next[0] = -1。对于给定的模式串：ABCDABD，它的最大长度表及next 数组分别如下：</p>
<center><img src="/images/next.jpg" alt="next"></center>

<p>上图中最大长度值为该字符位置的最长公共前缀与后缀长度，前最大长度值表向右移动一位，并将next[0]赋值为-1就得到了next数组。<strong>模式串next数组的求法是KMP算法中最难理解的部分</strong>。它需要对模式串进行递推搜索：</p>
<blockquote>
<ul>
<li>如果对于值k，已有p0 p1, …, pk-1 = pj-k pj-k+1, …, pj-1，相当于next[j] = k。<blockquote>
<ul>
<li>next[j] = k 代表p[j] 之前的模式串子串中，有长度为k 的相同前缀和后缀</li>
<li>有了这个next 数组，在KMP匹配中，当模式串中j 处的字符失配时，下一步用next[j]处的字符继续跟文本串匹配，相当于模式串向右移动j - next[j] 位。</li>
</ul>
</blockquote>
</li>
<li>递推问题：已知next [0, …, j]，如何求出next [j + 1]呢？<blockquote>
<ul>
<li>若p[k] == p[j]，则next[j + 1 ] = next [j] + 1 = k + 1</li>
<li>若p[k ] ≠ p[j]，如果此时p[ next[k] ] == p[j ]，则next[ j + 1 ] =  next[k] + 1，否则继续递归前缀索引k = next[k]，而后重复此过程。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<p>为何递归前缀索引k = next[k]，就能找到长度更小的相同前缀后缀呢?这又归根到next数组的含义。<strong>为了寻找长度相同的前缀后缀，我们拿前缀 p0 pk-1 pk 去跟后缀pj-k pj-1 pj匹配，如果pk 跟pj 失配，下一步就是用p[next[k]] 去跟pj 继续匹配，如果p[ next[k] ]跟pj还是不匹配，则下一步用p[ next[ next[k] ] ]去跟pj匹配。</strong>。相当于在不断的递归k = next[k]，直到要么找到长度更小的相同前缀后缀，要么没有长度更小的相同前缀后缀。</p>
<p>下面这段代码展示了模式串next数组的求法，其中data[k]表示前缀，data[j]表示后缀。</p>
 <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">int</span>[] <span class="keyword">next</span>()&#123;</span><br><span class="line">	<span class="keyword">int</span> <span class="keyword">next</span>[] = <span class="keyword">new</span> <span class="keyword">int</span>[length];</span><br><span class="line">	<span class="keyword">next</span>[<span class="number">0</span>] = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>, k = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(j &lt; length-<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(k == -<span class="number">1</span> || data[k] == data[j])&#123;</span><br><span class="line">			k++;</span><br><span class="line">			j++;</span><br><span class="line">			<span class="keyword">next</span>[j] = k;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			k = <span class="keyword">next</span>[k];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">next</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-2KMP算法实现">3.2KMP算法实现</h3><p>有了模式串next数组，再来实现KMP算法就变得简单很多了。KMP算法相对于朴素算法的改进在于，如果模式串在j位置失配，主串无需回溯，模式串每次回溯到next[j]位置。下面是KMP算法的实现代码。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">int</span> indexOf_KMP(SeqString t)&#123;</span><br><span class="line">	SeqString <span class="keyword">s</span> = this;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> <span class="keyword">next</span>[] = t.getNext();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(i &lt; <span class="keyword">s</span>.<span class="keyword">length</span> &amp;&amp; j &lt; t.<span class="keyword">length</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(j == -<span class="number">1</span> || <span class="keyword">s</span>.data[i] == t.data[j])&#123;</span><br><span class="line">			i++;</span><br><span class="line">			j++;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			j = <span class="keyword">next</span>[j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(j == t.<span class="keyword">length</span>)</span><br><span class="line">		<span class="keyword">return</span> i-j;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3next_数组的优化">3.3next 数组的优化</h3><p>如果用之前的next 数组方法求模式串“abab”的next 数组，可得其next 数组为-1 0 0 1（0 0 1 2整体右移一位，初值赋为-1），当它跟下图中的文本串去匹配的时候，发现b跟c失配，于是模式串右移j - next[j] = 3 - 1 =2位。</p>
<center><img src="/images/next1.jpg" alt="next优化1"></center>

<p>右移2位后，b又跟c失配。事实上，因为在上一步的匹配中，已经得知p.data[3] = b，与s.data[3] = c失配，在3位置失配，由于next[3]=1，而右移两位之后，让p.data[1] = b 再跟s.data[3]匹配时，必然失配。问题出在哪呢？</p>
<center><img src="/images/next2.jpg" alt="next优化2"></center>

<p>问题出在不该出现p.data[j] = p.data[ next[j] ]。为什么呢？理由是：当p.data[j] != s.data[i] 时，下次匹配必然是p.data[ next [j]] 跟s.data[i]匹配，如果p.data[j] = p.data[ next[j] ]，必然导致后一步匹配失败（因为p.data[j]已经跟s.data[i]失配，然后你还用跟p.data[j]等同的值p.data[next[j]]去跟s.data[i]匹配，很显然，必然失配），所以不能允许p.data[j] = p.data[ next[j ]]。如果出现了p.data[j] = p.data[ next[j] ]咋办呢？如果出现了，则需要再次递归，即令next[j] = next[ next[j] ]。</p>
<p>优化后的next数组的求法如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">int</span>[] getNext()&#123;</span><br><span class="line">	<span class="keyword">int</span> <span class="keyword">next</span>[] = new <span class="keyword">int</span>[<span class="keyword">length</span>];</span><br><span class="line">	<span class="keyword">next</span>[<span class="number">0</span>] = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">0</span>, k = -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(j &lt; <span class="keyword">length</span>-<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="regexp">//already</span> knows <span class="keyword">next</span>[j] = k, how to compute <span class="keyword">next</span>[j+<span class="number">1</span>]</span><br><span class="line">		<span class="keyword">if</span>(k == -<span class="number">1</span> || data[j] == data[k])&#123;</span><br><span class="line">			k++;</span><br><span class="line">			j++;</span><br><span class="line">			<span class="keyword">if</span>(data[j] != data[k])</span><br><span class="line">				<span class="keyword">next</span>[j] = k;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">next</span>[j] = <span class="keyword">next</span>[k];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			k = <span class="keyword">next</span>[k];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">next</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>利用优化过后的next 数组求法，可知模式串“abab”的新next数组为：-1 0 -1 0。下面这幅图揭示了KMP算法的实际执行过程。</p>
<center><img src="/images/kmp.jpg" alt="KMP算法图示"></center>

<p>上述部分图示和文字来源于 <a href="http://blog.csdn.net/v_july_v/article/details/7041827" target="_blank" rel="external">http://blog.csdn.net/v_july_v/article/details/7041827</a></p>
<h2 id="4-KMP算法的时间复杂度">4.KMP算法的时间复杂度</h2><p>如果文本串的长度为n，模式串的长度为m，那么匹配过程的时间复杂度为O(n)，算上计算next的O(m)时间，KMP的整体时间复杂度为O(m + n)。</p>

        </section>
        <hr/>
        <nav class="pagination" style="width:auto" role="pagination">
            
            <a data-pjax class="newer-posts" href="/2015/07/21/数据结构-多维数组和广义表/">← Prev Post</a>
            
            <a class="share-button" data-original-title title>Share this Post</a>
            
            <a data-pjax class="older-posts" href="/2015/07/20/数据结构-栈与队列/">Next Post →</a>
            
        </nav>
        <br/>
        <br/>
        <section id="comment">
            <div id="comment-box"></div>
        </section>


    </article>
</main>


  
<footer class="site-footer">
    
    <a class="subscribe icon-feed" href="atom.xml"><span class="tooltip">Subscribe!</span></a>
    
    <div class="inner">
        <section class="copyright"><a href="/"></a> &copy; zbvae's blog 2014</section>
        <section class="poweredby">Published with <a target="_blank" href="http://hexo.io/">Hexo   </a> and Theme by <a target="_blank" href="https://github.com/yuche/hexo-theme-kael">Kael</a></section>
    </div>
</footer>
</div>
</div><!-- /scroller -->

</div><!-- /pusher -->
</div><!-- /container -->
</div>

<!-- Easter eggs -->

<div class="egg animated">
    <a id="close-button" href="#">X</a>
    <div class="block">
        <div class="loading">
            <span class="ball1"></span>
            <span class="ball2"></span>
        </div>
    </div>
</div>
  
<script src="//cdn.staticfile.org/jquery/1.11.0/jquery.min.js"></script>
<script>
    if (!window.jQuery) {
        var script = document.createElement('script');
        script.src = "/js/jquery.min.js";
        document.body.appendChild(script);
    }
</script>
<script type="text/javascript" src="/js/lib.js"></script>
<script type="text/javascript" src="/js/main.js"></script>







</body>
</html>
