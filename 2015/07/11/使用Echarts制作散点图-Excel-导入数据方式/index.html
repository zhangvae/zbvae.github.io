<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>使用Echarts制作散点图(Excel 导入数据方式) | zbvae&#39;s blog</title>
  <meta name="description" content="这个世界怎么了，明明可以靠才华吃饭，偏要靠脸!" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/component.css" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <meta name="generator" content="zbvae's blog">
  <script src="http://static.duoshuo.com/embed.js"></script>
  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  

</head>
<body>
<div class="container">
    <div class="mp-pusher" id="mp-pusher">
        <i id="scroll-up" class="fa fa-angle-up"></i>
        <nav id="mp-menu" class="mp-menu">
            <div class="mp-level">
                <a data-pjax class="back-home" style="font-size: 20px" href="/"><h2 ><i class="fa fa-home"></i>
                        Home</h2></a>
                <ul class="first-level">
                    <li>
                        <a class="fa fa-archive" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;Archive</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-archive"></i>
                                Archive</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-archive" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2016/03/17/Java微信公众号应用部署在阿里云ECS/">Java微信公众号应用部署在阿里云ECS</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2016/03/08/CENTOS-6-5安装vncserver/">CENTOS 6.5安装vncserver</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2016/02/24/新新新年/">新新新年</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/31/Java-Web中文乱码问题解决方法/">Java Web中文乱码问题解决方法</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/28/数据结构-内排序算法/">数据结构-内排序算法</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/26/数据结构-图/">数据结构-图</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/23/数据结构-二叉树/">数据结构-二叉树</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/21/数据结构-多维数组和广义表/">数据结构-多维数组和广义表</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/20/数据结构-串/">数据结构-串</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/20/数据结构-栈与队列/">数据结构-栈与队列</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/19/数据结构-线性表/">数据结构-线性表</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/18/八皇后问题/">八皇后问题</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/12/Java-NIO-学习/">Java NIO 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-类集/">Java 类集</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-比较器/">Java 比较器</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/正则表达式/">正则表达式</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/XML-学习/">XML 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-JDBC-学习/">Java JDBC 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-多线程/">Java 多线程</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-反射/">Java 反射</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/使用Echarts制作散点图-Excel-导入数据方式/">使用Echarts制作散点图(Excel 导入数据方式)</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-对象克隆/">Java 对象克隆</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-对象序列化与反序列化/">Java 对象序列化与反序列化</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/11/Java-IO-学习/">Java IO 学习</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2015/07/09/使用Hexo和Github搭建自己的个人博客网站/">使用Hexo和Github搭建自己的个人博客网站</a>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-copy" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;Categories</a>

                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-copy"></i>
                                Categories</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-category" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-tags" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;Tags</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-tags"></i>
                                Tags</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-tag" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/Java学习/">&nbsp;&nbsp;&nbsp;Java学习</a>
                                    <small>9</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/云服务器/">&nbsp;&nbsp;&nbsp;云服务器</a>
                                    <small>2</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/微信公众号/">&nbsp;&nbsp;&nbsp;微信公众号</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/心情/">&nbsp;&nbsp;&nbsp;心情</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/技术/">&nbsp;&nbsp;&nbsp;技术</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/技术交流/">&nbsp;&nbsp;&nbsp;技术交流</a>
                                    <small>6</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/数据结构/">&nbsp;&nbsp;&nbsp;数据结构</a>
                                    <small>7</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/随笔/">&nbsp;&nbsp;&nbsp;随笔</a>
                                    <small>1</small>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    
                    <li class="mp-pjax"><a class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;About me</a></li>
                    <li><a class="fa fa-github" href="#">&nbsp;&nbsp;&nbsp;Github</a></li>

                </ul>

            </div>
        </nav>
        <div id="pjax">
            <div class="pjax-hidden" style="display: none">
                
                    <a  data-pjax href="/2016/03/17/Java微信公众号应用部署在阿里云ECS/">Java微信公众号应用部署在阿里云ECS</a>
                
                    <a  data-pjax href="/2016/03/08/CENTOS-6-5安装vncserver/">CENTOS 6.5安装vncserver</a>
                
                    <a  data-pjax href="/2016/02/24/新新新年/">新新新年</a>
                
                    <a  data-pjax href="/2015/07/31/Java-Web中文乱码问题解决方法/">Java Web中文乱码问题解决方法</a>
                
                    <a  data-pjax href="/2015/07/28/数据结构-内排序算法/">数据结构-内排序算法</a>
                
                    <a  data-pjax href="/2015/07/26/数据结构-图/">数据结构-图</a>
                
                    <a  data-pjax href="/2015/07/23/数据结构-二叉树/">数据结构-二叉树</a>
                
                    <a  data-pjax href="/2015/07/21/数据结构-多维数组和广义表/">数据结构-多维数组和广义表</a>
                
                    <a  data-pjax href="/2015/07/20/数据结构-串/">数据结构-串</a>
                
                    <a  data-pjax href="/2015/07/20/数据结构-栈与队列/">数据结构-栈与队列</a>
                
                    <a  data-pjax href="/2015/07/19/数据结构-线性表/">数据结构-线性表</a>
                
                    <a  data-pjax href="/2015/07/18/八皇后问题/">八皇后问题</a>
                
                    <a  data-pjax href="/2015/07/12/Java-NIO-学习/">Java NIO 学习</a>
                
                    <a  data-pjax href="/2015/07/11/Java-类集/">Java 类集</a>
                
                    <a  data-pjax href="/2015/07/11/Java-比较器/">Java 比较器</a>
                
                    <a  data-pjax href="/2015/07/11/正则表达式/">正则表达式</a>
                
                    <a  data-pjax href="/2015/07/11/XML-学习/">XML 学习</a>
                
                    <a  data-pjax href="/2015/07/11/Java-JDBC-学习/">Java JDBC 学习</a>
                
                    <a  data-pjax href="/2015/07/11/Java-多线程/">Java 多线程</a>
                
                    <a  data-pjax href="/2015/07/11/Java-反射/">Java 反射</a>
                
                    <a  data-pjax href="/2015/07/11/使用Echarts制作散点图-Excel-导入数据方式/">使用Echarts制作散点图(Excel 导入数据方式)</a>
                
                    <a  data-pjax href="/2015/07/11/Java-对象克隆/">Java 对象克隆</a>
                
                    <a  data-pjax href="/2015/07/11/Java-对象序列化与反序列化/">Java 对象序列化与反序列化</a>
                
                    <a  data-pjax href="/2015/07/11/Java-IO-学习/">Java IO 学习</a>
                
                    <a  data-pjax href="/2015/07/09/使用Hexo和Github搭建自己的个人博客网站/">使用Hexo和Github搭建自己的个人博客网站</a>
                
                
                
                    <a data-pjax href="/tags/Java学习/">&nbsp;&nbsp;Java学习</a>
                
                    <a data-pjax href="/tags/云服务器/">&nbsp;&nbsp;云服务器</a>
                
                    <a data-pjax href="/tags/微信公众号/">&nbsp;&nbsp;微信公众号</a>
                
                    <a data-pjax href="/tags/心情/">&nbsp;&nbsp;心情</a>
                
                    <a data-pjax href="/tags/技术/">&nbsp;&nbsp;技术</a>
                
                    <a data-pjax href="/tags/技术交流/">&nbsp;&nbsp;技术交流</a>
                
                    <a data-pjax href="/tags/数据结构/">&nbsp;&nbsp;数据结构</a>
                
                    <a data-pjax href="/tags/随笔/">&nbsp;&nbsp;随笔</a>
                
                <a data-pjax class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;About me</a>
            </div>
            <nav class="nexus">
                <li  style="border-left: 1px solid #c6d0da;">
                    <a id="trigger" href="#"><i class="fa fa-bars"></i></a>
                </li>
                <li ><a id="nexus-back" data-pjax href="/">zbvae&#39;s blog</a></li>
                
                <div id="nav-container">
                    <div class="post-navbar" style="line-height: 63px;display:none">
                        <li id="navbar-title"><a href="#">使用Echarts制作散点图(Excel 导入数据方式)</a></li>
                        <li id="navbar-toc" style="border-left: none">
                            <a style="padding-right: 15px">
                                <span id="toc-content" >Introduction</span><i class="fa fa-chevron-down" ></i>
                            </a>
                            <div class="hidden-box">
                                <ul id="toc"></ul>
                            </div>
                        </li>
                    </div>
                </div>
                
            </nav>

            <div class="scroller">
            <div class="scroller-inner">


<!-- -->
<!--<body class="post-template">-->
<!---->
  

<main class="content" role="main">
    <article class="post" >
    <span class="post-meta">
                  <div class="tag-tile">
                      
                      
                      <a data-pjax href='/tags/技术交流/' style='color:#D5D5D5'>技术交流</a>
                      
                      
                  </div>
                <h1 class="post-title" style="margin: 14px 0;color:#50585D">使用Echarts制作散点图(Excel 导入数据方式)</h1>

                    <div class="post-meta">
                        Post on<span class="fa fa-clock-o"></span>
                        <time datetime="2015-07-11T02:34:53.000Z"
                              itemprop="datePublished">2015-07-11</time>
                    </div>
    </span>

        <section class="post-content">
            <p><strong>摘要</strong>：Echarts是一款有效的js制图工具很多时候，其主要优势在于网页浏览时，具有非常炫酷的效果，但是将其保存为静态图像也很美观。我们在写工作报告或写论文的时候，都需要制作基本的统计图表以直观展示结果数据，虽然Excel提供的图表制作工具能满足要求，但美观度欠佳，也许可以调整，但还是需要很大的工作量，今天给大家介绍一款非常实用的且有效的制图工具，相信，您亲自使用之后就知道它有多妙了！<a id="more"></a></p>
<h2 id="1-Echarts简介">1.Echarts简介</h2><p>　　Echarts相当于一款JS插件，可以制作出绚丽多彩的图表，其支持制作的图表类型和可以使用的样式都非常丰富。本文以Echarts制作散点图为例，向大家展示该工具的实用性。</p>
<h2 id="2-Echarts使用">2.Echarts使用</h2><p>　　Echarts的使用门槛非常简单，但使用条件必须符合规则，在<a href="http://echarts.baidu.com/" target="_blank" rel="external">官网</a>上下载开发包之后，自己准备一个项目主文件夹，在该文件夹新建一个js文件夹（名称自选），将开发包下的build文件夹下的dist文件夹拷贝到js文件夹下，便可以开始使用了。</p>
<p>　　Echarts的使用方式可以分为<strong>AMD模块化导入</strong>和<strong>单文件导入</strong>方式，本文介绍一种简单的单文件导入方式，首先准备好一个html文件，导入echarts.js文件即可。当然你还需要准备一个div控件用于安放图表位置，也可以认为是要为Echarts实例化的Dom对象，这里JavaScript代码也放在body标签下。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"GBK"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>Echarts of scatter<span class="tag">&lt;/<span class="title">title</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--为Echarts准备一个大小为600*400的div--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"main"</span> <span class="attribute">style</span>=<span class="value">"width:600px;height:400px"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span> </span><br><span class="line">    <span class="comment">&lt;!--Echarts单文件导入--&gt;</span>     </span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"./js/dist/echarts.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>至此，Echarts文件已完成导入，在使用之前，还需要进行路径配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"GBK"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>Echarts of scatter<span class="tag">&lt;/<span class="title">title</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--为Echarts准备一个大小为600*400的div--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"main"</span> <span class="attribute">style</span>=<span class="value">"width:600px;height:400px"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span> </span><br><span class="line">    <span class="comment">&lt;!--Echarts单文件导入--&gt;</span>     </span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"./js/dist/echarts.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="less"></span><br><span class="line">        <span class="comment">//配置路径</span></span><br><span class="line">        <span class="tag">require</span><span class="class">.config</span>(&#123;</span><br><span class="line">            <span class="tag">paths</span>:&#123;         </span><br><span class="line">                 <span class="attribute">echarts</span>:<span class="string">'./js/dist'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;) </span><br><span class="line">    </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>路径配置好后，可以进行使用，首先需要指定要制作的图表，进行模块导入，可以根据需要导入多个图表模块：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="less">    </span><br><span class="line">    <span class="comment">//配置路径 </span></span><br><span class="line">    <span class="tag">require</span><span class="class">.config</span>(&#123;</span><br><span class="line">      	<span class="tag">paths</span>:&#123;</span><br><span class="line">        	<span class="attribute">echarts</span>:<span class="string">'./js/dist'</span></span><br><span class="line">      	&#125; </span><br><span class="line">    &#125;) </span><br><span class="line">    <span class="comment">//使用     </span></span><br><span class="line">    <span class="tag">require</span>(</span><br><span class="line">        [     </span><br><span class="line">            <span class="string">'echarts'</span>,</span><br><span class="line">            <span class="string">'echarts/chart/scatter'</span> </span><br><span class="line">        ] </span><br><span class="line">    )</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>基于原先的div创建echarts，并使用，主要是图表option的配置:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="scala"></span><br><span class="line">  <span class="comment">//配置路径</span></span><br><span class="line">  require.config(&#123;</span><br><span class="line">   	paths:&#123;</span><br><span class="line">    	echarts:'./js/dist'</span><br><span class="line">   	&#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//使用</span></span><br><span class="line">  require(</span><br><span class="line">   	[</span><br><span class="line">    	<span class="symbol">'echart</span>s',</span><br><span class="line">    	<span class="symbol">'echarts</span>/chart/scatter'</span><br><span class="line">   	],</span><br><span class="line">  </span><br><span class="line">   function(ec)&#123;</span><br><span class="line">    <span class="comment">//基于准备好的DOM，初始化echarts图表</span></span><br><span class="line">    <span class="keyword">var</span> myChart = ec.init(document.getElementById(<span class="symbol">'mai</span>n'),<span class="symbol">'shin</span>e'); <span class="comment">//这里的shine可以改成其他样式，可以参照官网实例的样式表</span></span><br><span class="line">    <span class="keyword">var</span> option = &#123;</span><br><span class="line">     	title:&#123;</span><br><span class="line">      		<span class="comment">//可以指定图表标题</span></span><br><span class="line">     	&#125;,</span><br><span class="line">     	renderAsImage : <span class="literal">true</span>,</span><br><span class="line">    	<span class="comment">//symbolList : ["emptyCircle"],</span></span><br><span class="line">     	tooltip:&#123;<span class="comment">//提示框的显示，主要具有web效果</span></span><br><span class="line">      		show:<span class="literal">true</span>,</span><br><span class="line">      		trigger: <span class="symbol">'axi</span>s',</span><br><span class="line">      		showDelay : <span class="number">0</span>,</span><br><span class="line">      		axisPointer:&#123;</span><br><span class="line">       			show: <span class="literal">true</span>,</span><br><span class="line">      	 		<span class="class"><span class="keyword">type</span> :</span> <span class="symbol">'cros</span>s',</span><br><span class="line">       			lineStyle: &#123;</span><br><span class="line">        			<span class="class"><span class="keyword">type</span> :</span> <span class="symbol">'dashe</span>d',</span><br><span class="line">        			width : <span class="number">1</span></span><br><span class="line">       			&#125;</span><br><span class="line">      		&#125;</span><br><span class="line">     	&#125;,</span><br><span class="line"> </span><br><span class="line">     	xAxis:[</span><br><span class="line">      		&#123;</span><br><span class="line">       			name : <span class="symbol">'Wr</span>G',</span><br><span class="line">       			<span class="class"><span class="keyword">type</span> :</span> <span class="symbol">'valu</span>e',</span><br><span class="line">       			scale:<span class="literal">true</span>,</span><br><span class="line">      		&#125;</span><br><span class="line">     	],</span><br><span class="line"></span><br><span class="line">     	yAxis:[</span><br><span class="line">      		&#123;</span><br><span class="line">       			name: <span class="symbol">'C</span>u',</span><br><span class="line">       			<span class="class"><span class="keyword">type</span> :</span> <span class="symbol">'valu</span>e',</span><br><span class="line">       			scale:<span class="literal">true</span>,</span><br><span class="line">      		&#125;</span><br><span class="line">     	],</span><br><span class="line"></span><br><span class="line">     	series:[</span><br><span class="line">      		&#123;</span><br><span class="line">       			<span class="string">"name"</span>:<span class="string">"CuOre"</span>,</span><br><span class="line">       			<span class="string">"type"</span>:<span class="string">"scatter"</span>,</span><br><span class="line">       			<span class="string">"data"</span>:xyData,<span class="comment">//注意这里的xyData就是关键的散点图显示数据，是一个二维数组，即数组内部每一个元素都是xy值对</span></span><br><span class="line">       			<span class="string">"markPoint"</span> : &#123;</span><br><span class="line">        			<span class="comment">//标记点 </span></span><br><span class="line">        			data : [</span><br><span class="line">        				&#123;<span class="class"><span class="keyword">type</span>:</span><span class="symbol">'ma</span>x'&#125;,</span><br><span class="line">        				&#123;<span class="class"><span class="keyword">type</span>:</span><span class="symbol">'mi</span>n'&#125; </span><br><span class="line">        			]</span><br><span class="line">       			&#125;,</span><br><span class="line">       			<span class="string">"markLine"</span> : &#123;</span><br><span class="line">            		<span class="comment">//标记线自己定制 </span></span><br><span class="line">        		&#125;</span><br><span class="line">      		&#125;</span><br><span class="line">     	]</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//为ECharts对象加载数据</span></span><br><span class="line">    myChart.setOption(option);</span><br><span class="line">   	&#125;</span><br><span class="line">  );</span><br><span class="line"> </span><br><span class="line"> </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>现在图表的各项已经配置完毕，关键就是xyData数据的充填，当然用户可以自行指定为：[[1,2],[2,2],[3,4],[4,5]],数据少的时候我们可以直接充填，但是数据条目一旦很多，人工输入就很难完成了，因此这里介绍一种从Excel导入数据,再利用js重新组装来进行xyData的充填。代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 以下是设置从Excel中加载数据--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">importXLS</span>(<span class="params">field</span>)</span>&#123;   </span><br><span class="line">       	<span class="keyword">var</span> fullpath = <span class="built_in">window</span>.document.location.pathname;</span><br><span class="line">       	<span class="keyword">var</span> pos1 = fullpath.indexOf(<span class="string">"/"</span>);</span><br><span class="line">       	<span class="keyword">var</span> fileName1 = fullpath.substring(pos1+<span class="number">1</span>);</span><br><span class="line">       	<span class="keyword">var</span> pos2 = fileName1.lastIndexOf(<span class="string">"/"</span>);</span><br><span class="line"> </span><br><span class="line">       	<span class="keyword">var</span> fileName = fileName1.substring(<span class="number">0</span>,pos2) + <span class="string">"/scatter_data.xls"</span>;<span class="comment">// xls文件的路径  </span></span><br><span class="line">       	objCon = <span class="keyword">new</span> ActiveXObject(<span class="string">"ADODB.Connection"</span>); </span><br><span class="line">       	objCon.Provider = <span class="string">"Microsoft.Jet.OLEDB.4.0"</span>;  </span><br><span class="line">       	objCon.ConnectionString = <span class="string">"Data Source="</span> + fileName + <span class="string">";Extended Properties=Excel 8.0;"</span>;  </span><br><span class="line">       	objCon.CursorLocation = <span class="number">1</span>;  </span><br><span class="line">       	objCon.Open;  </span><br><span class="line">       	<span class="keyword">var</span> strQuery;  </span><br><span class="line">     </span><br><span class="line">    	<span class="comment">//Get the SheetName  </span></span><br><span class="line">       	<span class="keyword">var</span> strSheetName = <span class="string">"Sheet1$"</span>; <span class="comment">//要导入的sheet的名字  </span></span><br><span class="line">  </span><br><span class="line">   		<span class="keyword">var</span> rsTemp =   <span class="keyword">new</span> ActiveXObject(<span class="string">"ADODB.Recordset"</span>);  </span><br><span class="line">   		rsTemp = objCon.OpenSchema(<span class="number">20</span>);  </span><br><span class="line">   		<span class="keyword">if</span>(!rsTemp.EOF)strSheetName = rsTemp.Fields(<span class="string">"Table_Name"</span>).Value;  </span><br><span class="line">   		rsTemp = <span class="literal">null</span>;  </span><br><span class="line"> </span><br><span class="line">   		rsExcel =   <span class="keyword">new</span> ActiveXObject(<span class="string">"ADODB.Recordset"</span>);  </span><br><span class="line">   		strQuery = <span class="string">"SELECT * FROM ["</span> + strSheetName + <span class="string">"]"</span>;  </span><br><span class="line">   		rsExcel.ActiveConnection = objCon;  </span><br><span class="line">   		rsExcel.Open(strQuery);  </span><br><span class="line">  </span><br><span class="line">   		<span class="keyword">var</span> res = [];  </span><br><span class="line">   		<span class="keyword">var</span> temp;  </span><br><span class="line">   		<span class="keyword">while</span>(!rsExcel.EOF)&#123;  </span><br><span class="line">    		temp = rsExcel.Fields(field).value; </span><br><span class="line">    		res.push(temp);       </span><br><span class="line">    		rsExcel.MoveNext;     </span><br><span class="line">   		&#125;   </span><br><span class="line"> </span><br><span class="line">   		<span class="comment">// Close the connection and dispose the file  </span></span><br><span class="line">   		objCon.Close;  </span><br><span class="line">   		objCon =<span class="literal">null</span>;  </span><br><span class="line">   		rsExcel = <span class="literal">null</span>;  </span><br><span class="line">   		<span class="keyword">return</span> res;   </span><br><span class="line"> 	&#125;  </span><br><span class="line"> </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>导入的Excel数据是读取某个字段的一维数组数据，我们需要导入x,y两个字段的数据，并组装成xyData二维数组格式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><br><span class="line">	<span class="function"><span class="keyword">function</span>(<span class="params">ec</span>)</span>&#123;</span><br><span class="line">	    <span class="keyword">var</span> xData = importXLS(<span class="number">1</span>);</span><br><span class="line">	    <span class="keyword">var</span> yData = importXLS(<span class="number">2</span>);</span><br><span class="line">	    <span class="keyword">var</span> xyData = [];</span><br><span class="line">	  </span><br><span class="line">	    <span class="keyword">var</span> i;</span><br><span class="line">	    <span class="comment">//转化为散点图需要的二维数组系列</span></span><br><span class="line">	    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;xData.length;i++)&#123;</span><br><span class="line">	     xyData.push(<span class="keyword">new</span> <span class="built_in">Array</span>(xData[i],yData[i]));</span><br><span class="line">	    &#125;</span><br><span class="line">	    </span><br><span class="line">	    <span class="comment">//基于准备好的DOM，初始化echarts图表</span></span><br><span class="line">	    <span class="keyword">var</span> myChart = ec.init(<span class="built_in">document</span>.getElementById(<span class="string">'main'</span>),<span class="string">'shine'</span>);</span><br><span class="line">	    ... <span class="comment">//接着上面的使用Echarts的代码</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样便实现了从Excel中导入数据，重新组装，充填为散点图所需要的二维数组格式。给一个本程序生成的静态图片如下：</p>
<center><img src="/images/scatter1.png" alt="散点图，样式为infographic"><img src="/images/scatter2.png" alt="散点图，样式为shine"></center>
        </section>
        <hr/>
        <nav class="pagination" style="width:auto" role="pagination">
            
            <a data-pjax class="newer-posts" href="/2015/07/11/Java-反射/">← Prev Post</a>
            
            <a class="share-button" data-original-title title>Share this Post</a>
            
            <a data-pjax class="older-posts" href="/2015/07/11/Java-对象克隆/">Next Post →</a>
            
        </nav>
        <br/>
        <br/>
        <section id="comment">
            <div id="comment-box"></div>
        </section>


    </article>
</main>


  
<footer class="site-footer">
    
    <a class="subscribe icon-feed" href="atom.xml"><span class="tooltip">Subscribe!</span></a>
    
    <div class="inner">
        <section class="copyright"><a href="/"></a> &copy; zbvae's blog 2014</section>
        <section class="poweredby">Published with <a target="_blank" href="http://hexo.io/">Hexo   </a> and Theme by <a target="_blank" href="https://github.com/yuche/hexo-theme-kael">Kael</a></section>
    </div>
</footer>
</div>
</div><!-- /scroller -->

</div><!-- /pusher -->
</div><!-- /container -->
</div>

<!-- Easter eggs -->

<div class="egg animated">
    <a id="close-button" href="#">X</a>
    <div class="block">
        <div class="loading">
            <span class="ball1"></span>
            <span class="ball2"></span>
        </div>
    </div>
</div>
  
<script src="//cdn.staticfile.org/jquery/1.11.0/jquery.min.js"></script>
<script>
    if (!window.jQuery) {
        var script = document.createElement('script');
        script.src = "/js/jquery.min.js";
        document.body.appendChild(script);
    }
</script>
<script type="text/javascript" src="/js/lib.js"></script>
<script type="text/javascript" src="/js/main.js"></script>







</body>
</html>
